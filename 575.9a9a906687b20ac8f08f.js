"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[575],{4575:function(e,t,r){r.r(t),r.d(t,{default:function(){return ee}});var n=r(9635),c=r(9041),a=r(797),o=r(2793),i=r(1549),s=r(9999),u=r(5599),l=["createdAt"];function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){m(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function m(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h(e,t){if(null==e)return{};var r,n,c=function(e,t){if(null==e)return{};var r,n,c={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(c[r]=e[r]);return c}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(c[r]=e[r])}return c}var p=(0,i.yM)(),j=(0,i.GW)((function(e){return u.h.get("articles/".concat(e)).then((function(e){return e.data.article})).then((function(e){var t=e.createdAt;return f(f({},h(e,l)),{},{createdAt:new Date(t).toDateString()})}))})),g=(0,i.GW)((function(e){return u.h.delete("articles/".concat(e))})),v=(0,c.Bq)(),b=v.state.map((function(e){return e.slug})),x=(0,i.nu)(j.doneData,{title:"",slug:"",body:"",createdAt:"",updatedAt:"",tagList:[],description:"",author:{username:"",bio:"",image:"",following:!1},favorited:!1,favoritesCount:0}),y=(0,i.$e)(x,s.o.bR,(function(e,t){return e.author.username===t.username}));(0,i.UP)({source:b,clock:v.open,target:j}),(0,i.UP)({source:b,clock:p,target:g}),g.done.watch((function(){o.m8.push("/")}));var O=r(8438);function P(e){return function(e){if(Array.isArray(e))return w(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return w(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var N=(0,i.yM)(),D=(0,i.GW)((function(e){return u.h.get("articles/".concat(e,"/comments")).then((function(e){return e.data.comments}))})),S=(0,i.GW)((function(e){var t=e.slug,r=e.body;return u.h.post("articles/".concat(t,"/comments"),{body:r}).then((function(e){return e.data.comment}))})),A=(0,i.GW)((function(e){var t=e.slug,r=e.id;return u.h.delete("articles/".concat(t,"/comments/").concat(r))})),k=(0,c.Bq)(),C=k.state.map((function(e){return e.slug})),U=(0,i.nu)(D.doneData,[]).on(S.doneData,(function(e,t){return[t].concat(P(e))})).on(A.done,(function(e,t){var r=t.params;return e.filter((function(e){return e.id!==r.id}))})),R=(0,O.Np)({fields:{comment:{init:""}}});(0,i.UP)({source:C,clock:C.updates,target:D}),(0,i.UP)({source:{slug:C,body:R.fields.comment.$value},clock:R.submit,target:S}),(0,i.eH)({from:S,to:R.reset}),(0,i.UP)({source:C,clock:N,fn:function(e,t){return{slug:e,id:t}},target:A});var $=(0,i.MT)({errors:{}}).on([S.failData,A.failData],(function(e,t){var r;return null===(r=t.response)||void 0===r?void 0:r.data})).reset(R.$touched),E=r(4246),M=function(){var e=(0,c.oR)(s.o.bR),t=e.image,r=e.username;return(0,E.jsxs)("div",{className:"card-footer",children:[(0,E.jsx)("img",{alt:r,className:"comment-author-img",src:t}),(0,E.jsx)(a.zx,{className:"btn-sm btn-primary",type:"submit",children:"Post Comment"})]})},W=function(){var e=(0,O.cI)(R),t=e.submit,r=e.fields;return(0,E.jsxs)(a.l0,{className:"card comment-form",onSubmit:function(e){e.preventDefault(),t()},children:[(0,E.jsx)("div",{className:"card-block",children:(0,E.jsx)(a.gx,{placeholder:"Write a comment...",rows:3,value:r.comment.value,onChange:function(e){return r.comment.onChange(e.target.value)}})}),(0,E.jsx)(M,{})]})},G=r(4289),z=function(e){var t=e.author,r=e.onClick,n=(0,c.oR)(s.o.bR).username===t.username;return(0,E.jsx)(o.g,{children:function(e){return e.isAuth&&n?(0,E.jsx)(a.zx,{className:"mod-options btn-delete",onClick:r,children:(0,E.jsx)("i",{className:"ion-trash-a"})}):null}})},L=function(e){var t=e.author,r=e.createdAt,n=e.id;return(0,E.jsxs)("div",{className:"card-footer",children:[(0,E.jsx)(G.rU,{className:"comment-author",to:"/@".concat(t.username),children:(0,E.jsx)("img",{alt:t.username,className:"comment-author-img",src:t.image})})," ",(0,E.jsx)(G.rU,{className:"comment-author",to:"/@".concat(t.username),children:t.username}),(0,E.jsx)("span",{className:"date-posted",children:new Date(r).toDateString()}),(0,E.jsx)(z,{author:t,onClick:function(){return N(n)}})]})};function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function F(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){I(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function I(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var q=function(e){var t=e.comment;return(0,E.jsxs)("div",{className:"card",children:[(0,E.jsx)("div",{className:"card-block",children:(0,E.jsx)("p",{className:"card-text",children:t.body})}),(0,E.jsx)(L,F({},t))]})},B=function(){return(0,E.jsx)(a.aV,{children:(0,c.sm)(U,{getKey:function(e){return e.id},fn:function(e){return(0,E.jsx)(q,{comment:e})}})})},V=function(){var e=(0,c.oR)($);return(0,E.jsx)(a.KM,{errors:e})},J=function(e){var t=e.slug;return(0,c.DD)(v,{slug:t}),(0,c.DD)(k,{slug:t}),(0,E.jsx)(o.g,{children:function(e){return e.isAuth?(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(V,{}),(0,E.jsx)(W,{}),(0,E.jsx)(B,{})]}):null}})},K=r(4080),X=function(){var e=(0,c.oR)(x).tagList;return(0,E.jsx)(a.PS,{children:e.map((function(e){return(0,E.jsx)(a.Vp,{children:e.toLowerCase()},e)}))})},Z=function(){var e=(0,c.oR)(x).body;return(0,E.jsx)(a.X2,{className:"article-content",children:(0,E.jsxs)("div",{className:"col-xs-12",children:[(0,E.jsx)(K.Z,{children:e}),(0,E.jsx)(X,{})]})})},H=r(9792),Q=function(){var e=(0,c.oR)(y),t=(0,c.oR)(x).slug;return(0,E.jsx)(E.Fragment,{children:e&&(0,E.jsxs)("span",{children:[(0,E.jsx)(G.rU,{to:"/editor/".concat(t),children:(0,E.jsxs)(a.zx,{className:"btn-sm btn-outline-secondary",children:[(0,E.jsx)("i",{className:"ion-edit"})," Edit Article"]})}),(0,E.jsxs)(a.zx,{className:"btn-sm btn-outline-danger",onClick:p,children:[(0,E.jsx)("i",{className:"ion-trash-a"})," Delete Article"]})]})})},Y=function(){var e=(0,c.oR)(x),t=e.title,r=e.author,n=e.createdAt;return(0,E.jsx)(a.jL,{children:(0,E.jsxs)(a.W2,{children:[(0,E.jsx)("h1",{children:t}),(0,E.jsx)(H.qn,{author:r,createdAt:n,children:(0,E.jsx)(Q,{})})]})})},_=function(){return(0,E.jsx)(o.g,{children:function(e){return e.isAuth?null:(0,E.jsxs)("p",{children:[(0,E.jsx)(G.rU,{to:"/login",children:"Sign in"})," or ",(0,E.jsx)(G.rU,{to:"/register",children:"sign up"})," to add comments on this article."]})}})},ee=function(){var e=(0,n.UO)().slug;(0,c.DD)(v,{slug:e});var t=(0,c.oR)(j.pending);return(0,E.jsx)(E.Fragment,{children:!t&&(0,E.jsxs)("div",{className:"article-page",children:[(0,E.jsx)(Y,{}),(0,E.jsxs)(a.T3,{children:[(0,E.jsx)(Z,{}),(0,E.jsx)("hr",{}),(0,E.jsx)("div",{className:"article-actions"}),(0,E.jsx)(a.X2,{children:(0,E.jsxs)("div",{className:"col-xs-12 col-md-8 offset-md-2",children:[(0,E.jsx)(J,{slug:e}),(0,E.jsx)(_,{})]})})]})]})})}},9792:function(e,t,r){r.d(t,{qn:function(){return p},p2:function(){return g},WG:function(){return v},xZ:function(){return b},Aw:function(){return d}});var n=r(1549),c=r(9041),a=r(5599),o=r(2793);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){u(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var l={currentPage:1,pageSize:10,status:(0,n.MT)("initial")},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=s(s({},l),e),r=(0,n.yM)(),i=(0,n.yM)(),u=(0,n.GW)((function(e){return a.h.post("articles/".concat(e,"/favorite")).then((function(e){return e.data}))})),d=(0,n.GW)((function(e){return a.h.delete("articles/".concat(e,"/favorite")).then((function(e){return e.data}))})),f=(0,n.MT)(t.pageSize),m=o.o4.RJ.map((function(e){var t;return null!==(t=new URLSearchParams(e).get("tag"))&&void 0!==t?t:""})),h=o.o4.RJ.map((function(e){var r,n=null!==(r=new URLSearchParams(e).get("page"))&&void 0!==r?r:t.currentPage;return Number(n)-1})),p=(0,n.MT)({articles:[],articlesCount:0}).on([u.done,d.done],(function(e,t){var r=t.params,n=t.result;return s(s({},e),{},{articles:e.articles.map((function(e){return e.slug!==r?e:s(s({},e),{},{favorited:n.article.favorited,favoritesCount:n.article.favoritesCount})}))})})),j=p.map((function(e){return e.articles})),g=p.map((function(e){return e.articlesCount})),v=t.status,b=(0,n.$e)(v,j,(function(e,t){return"done"===e&&0===t.length}));(0,n.UP)({source:o.o4.y5,clock:r,fn:function(e,t){return{path:e,page:t}}}).watch((function(e){var t=e.path,r=e.page;o.m8.replace("".concat(t,"?page=").concat(r))})),(0,n.lo)({source:i,filter:function(e){return!0===e.favorited},target:d.prepend((function(e){return e.slug}))}),(0,n.lo)({source:i,filter:function(e){return!1===e.favorited},target:u.prepend((function(e){return e.slug}))}),(0,n.lo)({source:u.failData,filter:function(e){var t;return 401===(null===(t=e.response)||void 0===t?void 0:t.status)}}).watch((function(){o.m8.push(o.nn.LOGIN)}));var x=(0,n.$e)({pageSize:f,currentPage:h,currentTag:m,totalPages:g,isEmptyFeed:b});return{Gate:(0,c.Bq)(),currentPageWasSet:r,favoriteToggled:i,setFavoriteArticleFx:u,setUnfavoriteArticleFx:d,$feed:p,$articles:j,$pageSize:f,$currentPage:h,$currentTag:m,$totalPages:g,$isEmptyFeed:b,useModel:function(){return(0,c.oR)(x)}}},f=r(4289),m=r(797),h=r(4246),p=function(e){var t=e.author,r=e.createdAt,n=e.children;return(0,h.jsxs)("div",{className:"article-meta",children:[(0,h.jsx)(f.rU,{to:"/@".concat(t.username),children:(0,h.jsx)("img",{alt:t.username,src:t.image})}),(0,h.jsxs)("div",{className:"info",children:[(0,h.jsx)(f.rU,{className:"author",to:"/@".concat(t.username),children:t.username}),(0,h.jsx)("span",{className:"date",children:new Date(r).toDateString()})]}),n]})},j=function(e){var t=e.active,r=e.onClick,n=e.children;return(0,h.jsxs)(m.zx,{className:"btn btn-sm btn-outline-primary","data-active":t,onClick:r,children:[(0,h.jsx)("i",{className:"ion-heart"})," ",n]})},g=function(e){var t=e.data,r=t.author,n=t.createdAt,c=t.slug,a=t.title,o=t.description,i=t.tagList,s=t.favorited,u=t.favoritesCount,l=e.onClick;return(0,h.jsxs)("article",{className:"article-preview",children:[(0,h.jsx)(p,{author:r,createdAt:n,children:(0,h.jsx)("div",{className:"pull-xs-right",children:(0,h.jsx)(j,{active:s,onClick:l,children:u})})}),(0,h.jsxs)(f.rU,{className:"preview-link",to:"/article/".concat(c),children:[(0,h.jsx)("h1",{children:a}),(0,h.jsx)("p",{children:o}),(0,h.jsx)("span",{children:"Read more..."}),(0,h.jsx)(m.PS,{children:i.map((function(e){return(0,h.jsx)(m.Vp,{children:e.toLowerCase()},e)}))})]})]})},v=function(e){var t=e.children;return(0,h.jsx)("ul",{className:"articles-wrapper list-unstyled",children:t})},b=function(e){return e.show?(0,h.jsx)("div",{className:"empty-articles article-preview",children:"No articles are here... yet."}):null}}}]);